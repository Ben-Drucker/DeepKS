
--- Model Summary ---
=========================================================================================================================================================================================================================================================================
Layer (type (var_name))                                           Input Shape                                        Output Shape                                       Param #                                            Trainable
=========================================================================================================================================================================================================================================================================
KinaseSubstrateRelationshipNN (KinaseSubstrateRelationshipNN)     [[64, 15], [64, 4128]]                             [64]                                               --                                                 True
├─Embedding (emb_site)                                            [64, 15]                                           [64, 15, 22]                                       484                                                True
├─Embedding (emb_kin)                                             [64, 4128]                                         [64, 4128, 22]                                     484                                                True
├─ModuleList (site_cnns)                                          --                                                 --                                                 --                                                 True
│    └─CNN (0)                                                    [64, 15, 22]                                       [64, 160]                                          --                                                 True
│    │    └─Transpose (transpose)                                 [64, 15, 22]                                       [64, 22, 15]                                       --                                                 --
│    │    └─Conv1d (conv)                                         [64, 22, 15]                                       [64, 20, 8]                                        3,540                                              True
│    │    └─ELU (activation)                                      [64, 20, 8]                                        [64, 20, 8]                                        --                                                 --
│    │    └─MaxPool1d (pool)                                      [64, 20, 8]                                        [64, 20, 8]                                        --                                                 --
│    │    └─Flatten (flat)                                        [64, 20, 8]                                        [64, 160]                                          --                                                 --
├─ModuleList (kin_cnns)                                           --                                                 --                                                 --                                                 True
│    └─CNN (0)                                                    [64, 4128, 22]                                     [64, 160]                                          --                                                 True
│    │    └─Transpose (transpose)                                 [64, 4128, 22]                                     [64, 22, 4128]                                     --                                                 --
│    │    └─Conv1d (conv)                                         [64, 22, 4128]                                     [64, 20, 4029]                                     44,020                                             True
│    │    └─ELU (activation)                                      [64, 20, 4029]                                     [64, 20, 4029]                                     --                                                 --
│    │    └─MaxPool1d (pool)                                      [64, 20, 4029]                                     [64, 20, 8]                                        --                                                 --
│    │    └─Flatten (flat)                                        [64, 20, 8]                                        [64, 160]                                          --                                                 --
├─Attention (attn)                                                [[64, 160], [64, 160]]                             [64, 1]                                            --                                                 True
│    └─Linear (attn)                                              [64, 160]                                          [64, 160]                                          25,760                                             True
│    └─Linear (attn)                                              [64, 160]                                          [64, 160]                                          (recursive)                                        True
├─Multiply (mult)                                                 [[64, 160], [64, 1]]                               [64, 160]                                          --                                                 --
├─Multiply (mult)                                                 [[64, 160], [64, 1]]                               [64, 160]                                          --                                                 --
├─Concatenation (cat)                                             [[64, 160], [64, 160]]                             [64, 320]                                          --                                                 --
├─Linear (linear)                                                 [64, 320]                                          [64, 50]                                           16,050                                             True
├─ELU (activation)                                                [64, 50]                                           [64, 50]                                           --                                                 --
├─Dropout (dropout)                                               [64, 50]                                           [64, 50]                                           --                                                 --
├─Linear (intermediate)                                           [64, 50]                                           [64, 25]                                           1,275                                              True
├─ELU (activation)                                                [64, 25]                                           [64, 25]                                           --                                                 --
├─Dropout (dropout)                                               [64, 25]                                           [64, 25]                                           --                                                 --
├─Linear (final)                                                  [64, 25]                                           [64, 1]                                            26                                                 True
=========================================================================================================================================================================================================================================================================
Total params: 91,639
Trainable params: 91,639
Non-trainable params: 0
Total mult-adds (G): 11.36
=========================================================================================================================================================================================================================================================================
Input size (MB): 1.06
Forward/backward pass size (MB): 88.21
Params size (MB): 0.37
Estimated Total Size (MB): 89.64
=========================================================================================================================================================================================================================================================================
